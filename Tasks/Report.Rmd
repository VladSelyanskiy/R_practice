---
title: "Язык R и среда разработки RStudio"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Задание 1 Первый сеанс RStudio.

1. Запустите RStudio Cloud (https://rstudio.cloud). Пройдите регистрацию.

2. В своем рабочем пространстве создайте новый проект PracticeTask1.

3. Создайте простой набор данных (в терминологии R — вектор), состоящий из чисел 1, 2 и 4, и присвойте ему имя х.
Выведите на экран фразу «Это мой первый сеанс работы с R».
``` {r}
x <- c(1, 2, 4)
x
```
``` {r}
print("Это мой первый сеанс работы с R")
```

4. Выполните команду, которая присваивает q значение (1,2,4,1,2,4,8), используя ранее определенный вектор x.
``` {r}
q <- c(x, x, 8)
q
```

5. Выведите на экран значение 3-го элемента вектора x.
``` {r}
x[3]
```

6. Выведите на экран элементы вектора x со 2 по 3
``` {r}
x[2:3]
```

7. Выведите на экран математическое ожидание и среднеквадратическое отклонение для элементов вектора x.
``` {r}
mean(x)
```
``` {r}
sd(x)
```

8. Выведите на экран перечень внутренних наборов данных, предназначенных для демонстраций.
``` {r}
data()
```

9. Вычислите математическое ожидание и среднеквадратическое отклонение для набора
данных Nile (этот набор содержит данные о течении Нила).
``` {r}
mean(Nile)
```
``` {r}
sd(Nile)
```

10. Выведите гистограмму этих данных:
``` {r}
hist(Nile)
```

11. Сохраните проект

12 Ответьте на вопросы:
1) Как сформировать вектор?
2) Что означает операция с (concatenate)?
3) Как вывести на экран значение переменной величины? 
4) Нужно ли указывать тип переменной величины? 
5) Как вывести на экран перечень демонстрационных наборов данных?
6) Как рассчитать среднеквадратическое отклонение?
7) Как рассчитать математическое ожидание?
8) Как построить гистограмму?

## Задание 2 Работа с функциями в языке R.

1. Запустите RStudio Cloud. Создайте новый проект PracticeTask2 в своем рабочем
пространстве.

2. Определите функцию с именем oddcount(), предназначенную для подсчета нечетных чисел в целочисленном векторе:
```{r}
# Функция подсчитывает количество нечетных целых чисел в x 
oddcount <- function(x) {
  k <- 0 # в начале вычислений количество нечетных чисел равно 0
  for (n in x) {
    if (n %% 2 == 1) {# %% - вычисление остатка
      k <- k+1 
    }
  }
  return(k)
}

```

3. Выполните команду Code – Source File...

4. В режиме интерпретатора вычислите количество нечетных чисел в сформированных в предыдущей работе наборов данных x и q с использованием созданной функции:
```{r}
print(oddcount(x))
print(oddcount(q))
```

5. Попытайтесь вывести в интерпретаторе значения переменных k и n. Что Вы получили?
```
Error:
! объект 'k' не найден
```

6. Определите функцию sum_2, складывающую два числа, одно из которых имеет значение по умолчанию, равное 5
Протестируйте работу функции. Сохраните файл в своей папке под именем lab2_2.
```{r}
sum_2 <- function(a, b = 5)
{
  return(a + b)
}

print(sum_2(3))
print(sum_2(3, 8))
```

7. Напишите функцию fx, определенную на всей числовой прямой
Протестируйте работу функции.
```{r}
fx <- function(x) ifelse(x <= -2, 1-(x+2)^2, ifelse(x <= 2, -x/2, (x-2)^2 + 1))

print(fx(4.5))
print(fx(-4.5))
print(fx(1))
```

8.	Сохраните проект.

9.	Ответьте на вопросы:
1)	Как определить функцию?
2)	Как описать тело функции?
3)	Как записывается оператор if в языке R?
4)	Как записывается оператор for в языке R?
5)	Какие переменные являются глобальными?
6)	Какие переменные являются локальными по отношению к функции?
7)	Как определить значения по умолчанию для аргументов функции? 
8)	В каком порядке должны располагаться аргументы функции, не имеющие значений по умолчанию, и аргументы, имеющие значения по умолчанию?

## Задание 3. Структуры данных в R.

1.	Запустите RStudio Cloud. В своем рабочем пространстве создайте новый проект PracticeTask3.

2.	Создайте вектор а1 из вектора a1 получите вектор а1, добавив в середину вектора число 161.
```{r}
a <- c(34, 5, 73, 12)
a1 <- c(a[1:(length(a)/2)], 161, a[(length(a)/2):length(a)])
a1
```

3.	Создайте фактор month1, содержащий названия весенних месяцев года, при этом должен быть задан полный перечень месяцев и установлен порядок следования месяцев.
```{r}
month1 <- factor(c("Март", "Апрель", "Май"), levels = c("Март", "Апрель", "Май"), ordered = T)
month1
```

4.	Сформируйте список emp, содержащий сведения о сотруднике: имя (name – имеет символьные значения); зарплата (salary – вещественное число), принадлежность к профсоюзу (union – логическое значение). Внесите данные об одном сотруднике: Irina, 40800.00, F. Выведите зарплату сотрудника. Измените зарплату сотрудника, задав значение 50000.00.
```{r}
emp <- list(name = "Irina",
            salary = 40800.00,
            union = F)
emp
```

5.	Создайте фрейм department, описав сотрудников отдела атрибутами: name; salary; union. Введите данные по 2-м сотрудникам. Выведите имена всех сотрудников. Выведите зарплату второго сотрудника.
```{r}
department <- data.frame(name = "Sergey",
            salary = 42000,
            union = T)
department <- rbind(department, emp)

print(department)
print(department$name)
print(department[2, 2])
```

6.	Создайте матрицу m размером 3х2. 
```{r}
m <- matrix(1:6, 3, 2)
```

7.	Сохраните проект.

## Задание 4. Управление данными в R.

1. Откройте файл PracticeTask3, созданный как результат выполнение предыдущего задания, сохраните объекты с именами subject1, department, month1 в файл mydata.RData.
```{r, echo=FALSE}
subject1 <- department[1,]
```
```{r}
save(subject1, department, month1, file = "mydata.RData")
```

2. Создайте новый файл с именем lab2.R и загрузите в него объекты из файла  mydata_lab1.RData, выведите объекты subject1, department, month1.
```{r}
rm(list = ls())
load("mydata.RData")
```

3. Сохраните текущий сеанс, воспользовавшись командой save.image().
```{r}
save.image()
```

4. Используя функцию rm() удалите объекты month1 и subject1, проверьте список оставшихся объектов, используя функцию ls(). 
Удалите все объекты. 
Используя файл .RData, восстановите объекты. 
```{r}
rm(month1, subject1)
ls()
```
```{r}
rm(list = ls())
ls()
```
```{r}
load("mydata.RData")
```

5. Откройте файл R, созданный в ходе выполнения предыдущего задания. Запишите в файл pt_data.csv фрейм данных pt_data, определив параметр row.names=FALSE.
Вернитесь в файл R текущей работы. Прочитайте содержимое файла pt_data.csv.
```{r}
pt_data <- read.csv("pt_data.csv", stringsAsFactors = F)

write.csv(pt_data, file = "pt_data.csv", row.names = F)
```

6. Загрузите файл usedcars.csv на сервер, если Вы используете среду RStudio Cloud, используя кнопку. 

7. Загрузите данные их файла usedcars.csv во фрейм usedcars.
```{r}
usedcars <- read.csv("usedcars.csv")
```

8. Отобразите структуру usedcars, используя команду str().
```{r}
str(usedcars)
```

9. Используя функцию summary() запросите статистику по всем числовым переменным usedcars.
```{r}
summary(usedcars)
```

10. Используя функцию mean() посчитайте средние значения для всех числовых переменных usedcars.
```{r}
sapply(usedcars[, c(3, 4)], mean, rm.na = T)
```

11. Используя функцию median() посчитайте медианы для всех числовых переменных usedcars.
```{r}
sapply(usedcars[, c(3, 4)], median, rm.na = T)
```

12. Изучите пятичисловую сводку для переменных price и mileage.
```{r}
summary(usedcars$price)
```
```{r}
summary(usedcars$mileage)
```

## Задание 5. Визуализация данных в R.